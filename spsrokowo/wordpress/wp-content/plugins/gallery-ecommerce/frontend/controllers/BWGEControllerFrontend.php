<?php

class BWGEControllerFrontend {
	////////////////////////////////////////////////////////////////////////////////////////
	// Events                                                                             //
	////////////////////////////////////////////////////////////////////////////////////////
	////////////////////////////////////////////////////////////////////////////////////////
	// Constants                                                                          //
	////////////////////////////////////////////////////////////////////////////////////////
	////////////////////////////////////////////////////////////////////////////////////////
	// Variables                                                                          //
	////////////////////////////////////////////////////////////////////////////////////////
	public $page;
	public $task;
	public $model;
	public $view;
	public $parmas;
	public $user;
	////////////////////////////////////////////////////////////////////////////////////////
	// Constructor & Destructor                                                           //
	////////////////////////////////////////////////////////////////////////////////////////
	public function __construct($params = "") {
		$this->user = get_current_user_id(); 
		$this->page = $params ? $params["page"] : BWGEHelper::get('controller');
		$this->params = $params;
		
		$task = BWGEHelper::get('task') ? BWGEHelper::get('task') : "display";
		$this->task = $task; 

		$model_class = 'BWGEModel' . ucfirst($this->page);
		$view_class = 'BWGEView' . ucfirst($this->page);

		require_once WD_BWGE_DIR . "/frontend/models/".$model_class.".php";
		$this->model = new $model_class($this->params);

		require_once WD_BWGE_DIR . "/frontend/views/".$view_class.".php";
		$this->view = new $view_class($this->model);
				
	}
	////////////////////////////////////////////////////////////////////////////////////////
	// Public Methods                                                                     //
	////////////////////////////////////////////////////////////////////////////////////////
	public function execute() {
        
		$task = $this->task; 
        if(method_exists($this, $task)){
            $this->$task();
        }
        else{
            echo  "<h2>". __("Not found","bwge")."</h2>";
           
        }
	}

	////////////////////////////////////////////////////////////////////////////////////////
	// Getters & Setters                                                                  //
	////////////////////////////////////////////////////////////////////////////////////////
	////////////////////////////////////////////////////////////////////////////////////////
	// Private Methods                                                                    //
	////////////////////////////////////////////////////////////////////////////////////////
	protected function display() {
		$view = $this->view;
		$view->display();	
	}


	////////////////////////////////////////////////////////////////////////////////////////
	// Listeners                                                                          //
	////////////////////////////////////////////////////////////////////////////////////////
}